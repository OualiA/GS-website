<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Green Science — Free Science Learning Platform</title>
  <link rel="icon" href="SS.ico">
  <meta name="theme-color" content="#0a0f0a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="description" content="Free science courses, quizzes, and study materials.">
  <meta property="og:title" content="Green Science — Free Science Learning Platform">
  <meta property="og:description" content="Free science courses, quizzes, and study materials. Soil science, plant nutrition, climatology.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Noto+Kufi+Arabic:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <noscript><div style="text-align:center;padding:80px 20px;font-family:sans-serif;color:#ccc;background:#0a0f0a;min-height:100vh"><h1 style="color:#2ECC71">Green Science</h1><p>JavaScript is required to use this site.</p></div></noscript>
  <div class="bg-layer"><div class="orb orb-1"></div><div class="orb orb-2"></div></div>
  <div class="grain"></div>

  <nav class="nav-bar" role="navigation" aria-label="Main navigation"><div class="nav-inner">
    <a href="index.html" class="nav-brand">
      <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
      <span data-i18n="siteName">Green Science</span>
    </a>
    <div class="nav-right">
      <button class="theme-btn" onclick="toggleTheme()" aria-label="Toggle theme"><svg class="theme-icon-light" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg><svg class="theme-icon-dark" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button>
      <button class="search-btn" onclick="openSearch()" title="Search (Ctrl+K)" aria-label="Search"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></button>
      <div class="lang-btns">
        <button class="lang-btn active" onclick="setLang('en')" aria-label="English">EN</button>
        <button class="lang-btn" onclick="setLang('fr')" aria-label="Français">FR</button>
        <button class="lang-btn" onclick="setLang('ar')" aria-label="العربية">عربي</button>
      </div>
    </div>
  </div></nav>

  <main class="wrap" role="main">
    <header>
      <div class="badge" data-i18n="badge">Free & Open Learning Platform</div>
      <h1 class="hero-title" data-i18n="heroTitle">Green Science</h1>
      <p class="hero-sub" data-i18n="heroSub">Free science courses, quizzes, and study materials.</p>
    </header>

    <div id="announcementSlot"></div>
    <div class="section-label"><span data-i18n="modulesLabel">Available Modules</span></div>
    <div class="card-grid" id="grid"></div>

    <!-- Recently Visited -->
    <div id="recentVisits" class="recent-section" style="display:none"></div>

    <!-- Bookmarks / Favorites -->
    <div id="bookmarksSlot" class="bookmarks-section" style="display:none"></div>

    <!-- News & Events -->
    <div id="newsSlot" class="news-section"></div>

    <!-- ═══ APPS ═══ -->
    <div class="section-label"><span data-i18n="appsLabel">Our Apps</span></div>
    <div id="appsContainer"></div>

    <!-- ═══ SEPARATOR ═══ -->
    <div class="section-divider">
      <div class="section-divider-line"></div>
      <div class="section-divider-icon">✦</div>
      <div class="section-divider-line"></div>
    </div>

    <!-- ═══ SERVICES ═══ -->
    <div class="section-label"><span data-i18n="servicesTitle">Our Services</span></div>
    <div id="servicesPreview"></div>

    <div class="social-row">
      <a href="https://www.facebook.com/Green.Science.A" target="_blank" rel="noopener" class="soc" title="Facebook"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
      <a href="https://www.youtube.com/@greenscience-9226" target="_blank" rel="noopener" class="soc" title="YouTube"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
      <a href="https://www.instagram.com/greensciencea/" target="_blank" rel="noopener" class="soc" title="Instagram"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z"/></svg></a>
    </div>
    <footer>
      <div id="contactSlot"></div>
      <div style="margin-top:16px">&copy; 2025 Green Science &mdash; <a href="https://www.youtube.com/@greenscience-9226" data-i18n="footerLink">Visit our channel</a></div>
    </footer>
  </main>

<script src="js/config.js"></script>

<script src="js/i18n.js"></script>

<script src="js/data.js"></script>

<!-- Module data files -->

<script src="js/modules/soil.js"></script>

<script src="js/modules/plant.js"></script>

<script src="js/modules/climate.js"></script>

<script src="js/modules/stat.js"></script>

<script src="js/news.js"></script>
<!-- Engine (must be last) -->

<script src="js/engine.js"></script>
<script>
const clipSvg = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2M9 5h6"/></svg>';

function onLangChange() { var s = window.scrollY; render(); renderApps(); renderAnnouncement(); renderRecentVisits(); renderBookmarks(); renderServicesPreview(); renderNews(); renderContactLinks(); currentApp = 0; goToApp(0); currentSvc = 0; requestAnimationFrame(function(){ window.scrollTo(0, s); }); }

const playSvg = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3.61 1.814L13.793 12 3.61 22.186a.996.996 0 0 1-.61-.92V2.734a1 1 0 0 1 .61-.92zm.96-.752l11.265 6.33L13.112 12l-8.54-8.538zm14.78 8.295L17.1 10.59l-2.72 2.72 2.72 2.72 2.25 1.233c.79.434.79 1.14 0 1.574l-2.25 1.233-2.72-2.72L11.66 14.63 3.61 22.68l14.78-8.295a1.003 1.003 0 0 0 0-1.728l.96-.6z"/></svg>';

var currentApp = 0;

function goToApp(idx) {
  if (idx < 0) idx = apps.length - 1;
  if (idx >= apps.length) idx = 0;
  currentApp = idx;
  var track = document.getElementById('appTrack');
  var offset = currentApp * (100 / apps.length);
  var isRTL = document.documentElement.dir === 'rtl';
  if (track) track.style.transform = 'translateX(' + (isRTL ? '' : '-') + offset + '%)';
  // Update dots
  document.querySelectorAll('.carousel-dot').forEach(function(d, i) {
    d.classList.toggle('active', i === currentApp);
  });
  // Update counter
  var counter = document.getElementById('appCounter');
  if (counter) counter.textContent = (currentApp + 1) + ' / ' + apps.length;
}

function renderApps() {
  var c = document.getElementById('appsContainer');
  if (!c || apps.length === 0) return;

  var h = '';
  h += '<div class="carousel">';

  // Arrows + counter row (only if more than 1 app)
  if (apps.length > 1) {
    h += '<div class="carousel-nav">';
    h += '<button class="carousel-arrow" onclick="goToApp(currentApp - 1)">' +
      '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>';
    h += '<span class="carousel-counter" id="appCounter">1 / ' + apps.length + '</span>';
    h += '<button class="carousel-arrow" onclick="goToApp(currentApp + 1)">' +
      '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg></button>';
    h += '</div>';
  }

  // Track
  h += '<div class="carousel-viewport"><div class="carousel-track" id="appTrack" style="width:' + (apps.length * 100) + '%">';
  apps.forEach(function(app, ai) {
    h += '<div class="carousel-slide" style="width:' + (100 / apps.length) + '%">';
    h += '<div class="app-card">';

    // Header: icon + name + description
    h += '<div class="app-header">';
    h += '<div class="app-icon">' + app.icon + '</div>';
    h += '<div class="app-header-info">';
    h += '<div class="app-name">' + localText(app.name) + '</div>';
    h += '<div class="app-desc">' + localText(app.description) + '</div>';
    h += '</div></div>';

    // Video
    if (app.videoId) {
      h += '<div class="app-video"><div class="video-frame">' +
        '<iframe src="https://www.youtube-nocookie.com/embed/' + app.videoId + '?rel=0&modestbranding=1" ' +
        'allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" ' +
        'allowfullscreen loading="lazy" referrerpolicy="strict-origin-when-cross-origin"></iframe></div></div>';
    }

    // ★ Download button — in the middle
    h += '<div class="app-download-row">';
    h += '<a href="' + (app.storeUrl || '#') + '" target="_blank" rel="noopener" class="store-btn">' +
      dlSvg + ' ' + tr('download') + '</a>';
    h += '</div>';

    // Steps
    if (app.steps && app.steps.length > 0) {
      h += '<div class="how-to">';
      app.steps.forEach(function(s, i) {
        h += '<div class="how-step"><div class="num">' + (i + 1) + '</div>' +
          '<h4>' + localText(s.title) + '</h4>' +
          '<p>' + localText(s.desc) + '</p></div>';
      });
      h += '</div>';
    }

    h += '</div></div>'; // /app-card /carousel-slide
  });
  h += '</div></div>'; // /track /viewport

  // Dots (only if more than 1)
  if (apps.length > 1) {
    h += '<div class="carousel-dots">';
    apps.forEach(function(_, i) {
      h += '<button class="carousel-dot' + (i === 0 ? ' active' : '') + '" onclick="goToApp(' + i + ')"></button>';
    });
    h += '</div>';
  }

  h += '</div>'; // /carousel
  c.innerHTML = h;
  currentApp = 0;

  // Touch/swipe support
  var vp = document.querySelector('.carousel-viewport');
  if (vp) {
    var startX = 0, moveX = 0;
    vp.addEventListener('touchstart', function(e) { startX = e.touches[0].clientX; moveX = 0; }, {passive: true});
    vp.addEventListener('touchmove', function(e) { moveX = e.touches[0].clientX - startX; }, {passive: true});
    vp.addEventListener('touchend', function() {
      var isRTL = document.documentElement.dir === 'rtl';
      if (moveX > 50) goToApp(currentApp + (isRTL ? 1 : -1));
      else if (moveX < -50) goToApp(currentApp + (isRTL ? -1 : 1));
    });
  }
}

function render() {
  const g = document.getElementById('grid');
  g.innerHTML = '';
  // Sort modules alphabetically by localized title
  var sorted = modules.slice().sort(function(a, b) {
    return localText(a.title).localeCompare(localText(b.title), currentLang);
  });
  sorted.forEach(mod => {
    const subCount = mod.subModules ? mod.subModules.length : 0;
    const topicCount = mod.subModules ? mod.subModules.reduce((s,sm) => s + (sm.topics ? sm.topics.length : 0), 0) : 0;
    const grad = catGradients[mod.category] || catGradients.general;
    const a = document.createElement('a');
    a.href = 'pages/module.html?id=' + mod.id;
    a.className = 'card';
    a.innerHTML =
      '<div class="card-top">' +
        '<div class="card-icon" style="background:' + grad + '">' + mod.icon + '</div>' +
        '<div class="card-info">' +
          '<div class="card-title">' + localText(mod.title) + '</div>' +
          '<div class="card-desc">' + localText(mod.description) + '</div>' +
        '</div></div>' +
      '<div class="card-stats">' +
        '<span class="stat">' + clipSvg + subCount + ' ' + tr('subModulesLabel').toLowerCase() + '</span>' +
        '<span class="stat-dot">·</span>' +
        '<span class="stat">' + topicCount + ' ' + tr('topicsLabel').toLowerCase() + '</span>' +
        '<div class="card-arrow">' + arrowSvg + '</div>' +
      '</div>';
    g.appendChild(a);
  });
}

var currentSvc = 0;

function goToSvc(idx) {
  if (idx < 0) idx = services.length - 1;
  if (idx >= services.length) idx = 0;
  currentSvc = idx;
  var track = document.getElementById('svcTrack');
  var offset = currentSvc * (100 / services.length);
  var isRTL = document.documentElement.dir === 'rtl';
  if (track) track.style.transform = 'translateX(' + (isRTL ? '' : '-') + offset + '%)';
  document.querySelectorAll('.svc-dot').forEach(function(d, i) {
    d.classList.toggle('active', i === currentSvc);
  });
  var counter = document.getElementById('svcCounter');
  if (counter) counter.textContent = (currentSvc + 1) + ' / ' + services.length;
}

function renderServicesPreview() {
  var el = document.getElementById('servicesPreview');
  if (!el || typeof services === 'undefined' || services.length === 0) return;

  var h = '<div class="carousel svc-carousel">';

  // Nav arrows + counter
  if (services.length > 1) {
    h += '<div class="carousel-nav">';
    h += '<button class="carousel-arrow" onclick="goToSvc(currentSvc - 1)">' +
      '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>';
    h += '<span class="carousel-counter" id="svcCounter">1 / ' + services.length + '</span>';
    h += '<button class="carousel-arrow" onclick="goToSvc(currentSvc + 1)">' +
      '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 6 15 12 9 18"/></svg></button>';
    h += '</div>';
  }

  // Track
  h += '<div class="carousel-viewport"><div class="carousel-track" id="svcTrack" style="width:' + (services.length * 100) + '%">';
  services.forEach(function(svc) {
    var feats = svc.features[currentLang] || svc.features.en;
    h += '<div class="carousel-slide" style="width:' + (100 / services.length) + '%">';
    h += '<div class="svc-slide-card">';

    // Header
    h += '<div class="svc-slide-header">' +
      '<div class="svc-slide-icon" style="background:' + svc.gradient + '">' + svc.icon + '</div>' +
      '<div class="svc-slide-info">' +
        '<div class="svc-slide-title">' + localText(svc.title) + '</div>' +
        '<div class="svc-preview-badge">' + tr('servicesComingSoon') + '</div>' +
      '</div></div>';

    // Description
    h += '<div class="svc-slide-desc">' + localText(svc.desc) + '</div>';

    // Features
    h += '<div class="svc-slide-features">';
    feats.forEach(function(f) {
      h += '<span class="service-feature-tag">' + f + '</span>';
    });
    h += '</div>';

    // Sample / Tutorial buttons
    h += buildSvcActions(svc);

    h += '</div></div>';
  });
  h += '</div></div>';

  // Dots
  if (services.length > 1) {
    h += '<div class="carousel-dots">';
    services.forEach(function(_, i) {
      h += '<button class="carousel-dot svc-dot' + (i === 0 ? ' active' : '') + '" onclick="goToSvc(' + i + ')"></button>';
    });
    h += '</div>';
  }

  h += '</div>'; // /carousel

  // CTA button
  h += '<div class="svc-cta-row">' +
    '<a href="pages/services.html" class="svc-choose-btn">' +
      tr('servicesChoose') +
      ' <span class="svc-arrow">' + arrowSvg + '</span>' +
    '</a></div>';

  el.innerHTML = h;
  currentSvc = 0;

  // Touch/swipe
  var vp = el.querySelector('.carousel-viewport');
  if (vp) {
    var startX = 0, moveX = 0;
    vp.addEventListener('touchstart', function(e) { startX = e.touches[0].clientX; moveX = 0; }, {passive: true});
    vp.addEventListener('touchmove', function(e) { moveX = e.touches[0].clientX - startX; }, {passive: true});
    vp.addEventListener('touchend', function() {
      var isRTL = document.documentElement.dir === 'rtl';
      if (moveX > 50) goToSvc(currentSvc + (isRTL ? 1 : -1));
      else if (moveX < -50) goToSvc(currentSvc + (isRTL ? -1 : 1));
    });
  }
}

setLang(initLang());
renderApps();
renderAnnouncement();
renderRecentVisits();
renderBookmarks();
renderServicesPreview();
renderNews();
renderContactLinks();
</script>
</body>
</html>
